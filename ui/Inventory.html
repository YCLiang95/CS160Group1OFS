<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>Inventory</title>
</head>

<body onLoad="load()">
	<select id="selectList" onChange="display()">
	</select>
	
	<div id="productWindow">
	</div>
	<script>
		var productList = new Object();
		
		function load(){
			getInventory();
			getProductList();
		}
		
		function getProductList(){
			var list = document.getElementById("selectList");
			
			for (var i = 0; i < productList.length; i ++){
				//var container = `<option value="${productList[i].mid}">${productList[i].name}</option>`;
				var option = document.createElement("option");
				option.setAttribute("value", productList[i].mid);
				var text = document.createTextNode(productList[i].name);
				option.appendChild(text);
				//option.innerHTML = container;
				list.add(option);
			}
		}
		
		function getInventory(){
			var xhttp = new XMLHttpRequest();
			xhttp.onreadystatechange = function() {
        		if (this.readyState == 4 && this.status == 200) {
					var s = JSON.parse(this.responseText);
					if (s.code == 200){
						productList = s.data;
					} else alert("Failed to obtain product list");
       			}	
    		};
    		xhttp.open("POST", "http://47.254.94.78:8085/cs160/mechandise/list", false);
    		xhttp.send(); 
			return false;
		}
		
		function display(){
			var list = document.getElementById("selectList");
			alert(list.value + "Selected" + " mid: " +list.options[list.selectedIndex].value);
		}
		
		function save(){
			var xhttp = new XMLHttpRequest();
			xhttp.onreadystatechange = function() {
        		if (this.readyState == 4 && this.status == 200) {
					var s = JSON.parse(this.responseText);
					if (s.code == 200){
						productList = s.data;
					} else alert("Failed to obtain product list");
       			}	
    		};
    		xhttp.open("POST", "http://47.254.94.78:8085/cs160/mechandise/save", false);
    		xhttp.send(); 
			return false;
		}
		
		function update(){
			var xhttp = new XMLHttpRequest();
			xhttp.onreadystatechange = function() {
        		if (this.readyState == 4 && this.status == 200) {
					var s = JSON.parse(this.responseText);
					if (s.code == 200){
						productList = s.data;
					} else alert("Failed to obtain product list");
       			}	
    		};
    		xhttp.open("POST", "http://47.254.94.78:8085/cs160/mechandise/update", false);
    		xhttp.send(); 
			return false;
		}
	</script>
</body>
</html>
